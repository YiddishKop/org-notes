<p>
<code>prettify-symbols-mode</code> is a very nice minor-mode that is a little too modest
for its own good. You can turn it on right now if you‚Äôre using a recent Emacs,
but it‚Äôll do nothing more than turn <code>lambda</code> into <code>Œª</code> in <code>emacs-lisp-mode</code>.
Still, it‚Äôs powerful and versatile and deserves that you give it a try. To
extend its feature-set you can install packages or customize it yourself, and
that‚Äôs what we‚Äôre here to do today, specifically in <code>clojure-mode</code>.
</p>

<p>
First of all, let‚Äôs make sure it‚Äôs turned on.
</p>
<figure class="highlight"><pre><code class="language-cl" data-lang="cl"><span class="p">(</span><span class="nv">global-prettify-symbols-mode</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1">;; We're going to play with this below.</span>
<span class="p">(</span><span class="nb">defvar</span> <span class="nv">endless/clojure-prettify-alist</span> <span class="o">'</span><span class="p">())</span></code></pre></figure>

<p>
If you read the docstring for this mode, it‚Äôll explain that any symbol can be
displayed as any character, so the first thing that comes to my mind is
displaying <code>&lt;=</code> or <code>&gt;=</code> as <code>‚â§</code> or <code>‚â•</code>. But that comes with a drawback. Suddenly
that symbol is 1 character shorter, so Emacs is going to indent sexps
accordingly, and people reading your code will see bad indentation.
</p>

<p>
The solution is to configure <code>prettify-symbols-mode</code> to compose these symbols in
a special way. This feature is somewhat accidental, and wasn‚Äôt even documented
in the last release. The composition rules are slightly complicated to write,
and for that I‚Äôll point to the docstrings of <a href="http://doc.endlessparentheses.com/Fun/compose-region"><code>compose-region</code></a> (see the third
argument) and <a href="http://doc.endlessparentheses.com/Var/reference-point-alist"><code>reference-point-alist</code></a>. Below are several examples you can toy
around with.
</p>

<p>
One way to fix the width, is to join two spaces together, and then stick the
inequality on top of them.
</p>
<figure class="highlight"><pre><code class="language-cl" data-lang="cl"><span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'endless/clojure-prettify-alist</span>
             <span class="o">'</span><span class="p">(</span><span class="s">"&gt;="</span> <span class="o">.</span> <span class="p">(</span><span class="nv">?\s</span> <span class="p">(</span><span class="nv">Br</span> <span class="o">.</span> <span class="nv">Bl</span><span class="p">)</span> <span class="nv">?\s</span> <span class="p">(</span><span class="nv">Bc</span> <span class="o">.</span> <span class="nv">Bc</span><span class="p">)</span> <span class="nv">?</span><span class="err">‚â•</span><span class="p">)))</span>
<span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'endless/clojure-prettify-alist</span>
             <span class="o">'</span><span class="p">(</span><span class="s">"&lt;="</span> <span class="o">.</span> <span class="p">(</span><span class="nv">?\s</span> <span class="p">(</span><span class="nv">Br</span> <span class="o">.</span> <span class="nv">Bl</span><span class="p">)</span> <span class="nv">?\s</span> <span class="p">(</span><span class="nv">Bc</span> <span class="o">.</span> <span class="nv">Bc</span><span class="p">)</span> <span class="nv">?</span><span class="err">‚â§</span><span class="p">)))</span></code></pre></figure>
<p>
However, I find this looks a little ‚Äútoo spacey‚Äù.<br  />
<a href="/images/prettify-inequalities-2.png"><img src="/images/prettify-inequalities-2.png" alt="prettify-inequalities-2.png" /></a>
</p>

<p>
The option I prefer is to just add a small dot before the symbol. This makes it
clear that the symbol occupies the space of two characters, while still looking
nicer than a plain <code>&lt;=</code>.
</p>
<figure class="highlight"><pre><code class="language-cl" data-lang="cl"><span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'endless/clojure-prettify-alist</span>
             <span class="o">'</span><span class="p">(</span><span class="s">"&lt;="</span> <span class="o">.</span> <span class="p">(</span><span class="nv">?</span><span class="err">¬∑</span> <span class="p">(</span><span class="nv">Br</span> <span class="o">.</span> <span class="nv">Bl</span><span class="p">)</span> <span class="nv">?</span><span class="err">‚â§</span><span class="p">)))</span>
<span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'endless/clojure-prettify-alist</span>
             <span class="o">'</span><span class="p">(</span><span class="s">"&gt;="</span> <span class="o">.</span> <span class="p">(</span><span class="nv">?</span><span class="err">¬∑</span> <span class="p">(</span><span class="nv">Br</span> <span class="o">.</span> <span class="nv">Bl</span><span class="p">)</span> <span class="nv">?</span><span class="err">‚â•</span><span class="p">)))</span></code></pre></figure>
<p>
Which will look like this:<br  />
<a href="/images/prettify-inequalities-1.png"><img src="/images/prettify-inequalities-1.png" alt="prettify-inequalities-1.png" /></a>
</p>

<p>
Then there are the <code>-&gt;</code> and <code>-&gt;&gt;</code> macros, which are in dire need of a makeover
if you ask me. The solution I currently use is a spaced-out version of <code>ü†ä</code>
(you could also use <code>‚á®</code>, <code>ü°í</code>, or <code>‚Üí</code>).
</p>
<figure class="highlight"><pre><code class="language-cl" data-lang="cl"><span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'endless/clojure-prettify-alist</span>
             <span class="o">'</span><span class="p">(</span><span class="s">"-&gt;"</span> <span class="o">.</span> <span class="p">(</span><span class="nv">?\s</span> <span class="p">(</span><span class="nv">Br</span> <span class="o">.</span> <span class="nv">Bl</span><span class="p">)</span> <span class="nv">?\s</span> <span class="p">(</span><span class="nv">Bc</span> <span class="o">.</span> <span class="nv">Bc</span><span class="p">)</span> <span class="nv">?</span><span class="err">ü†ä</span><span class="p">)))</span>
<span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'endless/clojure-prettify-alist</span>
             <span class="o">'</span><span class="p">(</span><span class="s">"-&gt;&gt;"</span> <span class="o">.</span> <span class="p">(</span><span class="nv">?\s</span> <span class="p">(</span><span class="nv">Br</span> <span class="o">.</span> <span class="nv">Bl</span><span class="p">)</span> <span class="nv">?\s</span> <span class="p">(</span><span class="nv">Br</span> <span class="o">.</span> <span class="nv">Bl</span><span class="p">)</span> <span class="nv">?\s</span>
                            <span class="p">(</span><span class="nv">Bc</span> <span class="o">.</span> <span class="nv">Br</span><span class="p">)</span> <span class="nv">?</span><span class="err">ü†ä</span> <span class="p">(</span><span class="nv">Bc</span> <span class="o">.</span> <span class="nv">Bl</span><span class="p">)</span> <span class="nv">?</span><span class="err">ü†ä</span><span class="p">)))</span></code></pre></figure>
<p>
Because the <code>ü†ä</code> character is wider than a regular character (at least on my
font), this turns out look quite nice.<br  />
<a href="/images/prettify-threading-2.png"><img src="/images/prettify-threading-2.png" alt="prettify-threading-2.png" /></a>
</p>

<p>
If you don‚Äôt like that, there‚Äôs also the option of adding one or two dashes
inside the symbols to make our fake arrow prettier.
</p>
<figure class="highlight"><pre><code class="language-cl" data-lang="cl"><span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'endless/clojure-prettify-alist</span>
             <span class="o">'</span><span class="p">(</span><span class="s">"-&gt;"</span> <span class="o">.</span> <span class="p">(</span><span class="nv">?-</span> <span class="p">(</span><span class="nv">Br</span> <span class="o">.</span> <span class="nv">Bc</span><span class="p">)</span> <span class="nv">?-</span> <span class="p">(</span><span class="nv">Br</span> <span class="o">.</span> <span class="nv">Bc</span><span class="p">)</span> <span class="nv">?&gt;</span><span class="p">)))</span>
<span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'endless/clojure-prettify-alist</span>
             <span class="o">'</span><span class="p">(</span><span class="s">"-&gt;&gt;"</span> <span class="o">.</span>  <span class="p">(</span><span class="nv">?\s</span> <span class="p">(</span><span class="nv">Br</span> <span class="o">.</span> <span class="nv">Bl</span><span class="p">)</span> <span class="nv">?\s</span> <span class="p">(</span><span class="nv">Br</span> <span class="o">.</span> <span class="nv">Bl</span><span class="p">)</span> <span class="nv">?\s</span>
                             <span class="p">(</span><span class="nv">Bl</span> <span class="o">.</span> <span class="nv">Bl</span><span class="p">)</span> <span class="nv">?-</span> <span class="p">(</span><span class="nv">Bc</span> <span class="o">.</span> <span class="nv">Br</span><span class="p">)</span> <span class="nv">?-</span> <span class="p">(</span><span class="nv">Bc</span> <span class="o">.</span> <span class="nv">Bc</span><span class="p">)</span> <span class="nv">?&gt;</span>
                             <span class="p">(</span><span class="nv">Bc</span> <span class="o">.</span> <span class="nv">Bl</span><span class="p">)</span> <span class="nv">?-</span> <span class="p">(</span><span class="nv">Br</span> <span class="o">.</span> <span class="nv">Br</span><span class="p">)</span> <span class="nv">?&gt;</span><span class="p">)))</span></code></pre></figure>
<p>
Here‚Äôs what they look like with this, compared to what they usually look like.<br  />
<a href="/images/prettify-threading-1.png"><img src="/images/prettify-threading-1.png" alt="prettify-threading-1.png" /></a>
</p>

<p>
And finally, none of this will work if we don‚Äôt set it up. Note that
<code>clojure-mode</code> already defines <code>fn</code> to display as <code>Œª</code>, so we don‚Äôt need to
configure this one.
</p>
<figure class="highlight"><pre><code class="language-cl" data-lang="cl"><span class="p">(</span><span class="nv">eval-after-load</span> <span class="ss">'clojure-mode</span>
  <span class="o">'</span><span class="p">(</span><span class="k">setq</span> <span class="nv">clojure--prettify-symbols-alist</span>
         <span class="p">(</span><span class="nb">append</span> <span class="nv">endless/clojure-prettify-alist</span>
                 <span class="nv">clojure--prettify-symbols-alist</span><span class="p">)))</span>
<span class="p">(</span><span class="nv">eval-after-load</span> <span class="ss">'lisp-mode</span>
  <span class="o">'</span><span class="p">(</span><span class="k">setq</span> <span class="nv">lisp--prettify-symbols-alist</span>
         <span class="p">(</span><span class="nb">append</span> <span class="nv">endless/clojure-prettify-alist</span>
                 <span class="nv">lisp--prettify-symbols-alist</span><span class="p">)))</span></code></pre></figure>

   <p><a href="http://endlessparentheses.com/using-prettify-symbols-in-clojure-and-elisp-without-breaking-indentation.html?source=rss#disqus_thread">Comment on this.</a></p>
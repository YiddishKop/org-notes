* 数据挖掘中适用于分类的时序数据特征提取方法
** 基本信息
   林 珠 1 , 邢 延 2
   (广东省计算中心, 广州 510033) 2
   (广东工业大学 自动化学院, 广州 510006)
   摘 要: 特征提取在提高分类的准确性中起着非常关键的作用. 对时序特征提取的方法进行归纳分类, 将有利于
   对特征提取整体性, 全面性的认识. 回顾现有的时间序列中特征提取的方法, 将其总结为四大类, 它们分别是基
   于基本统计方法的特征提取、基于模型的特征提取、基于变换的特征提取、基于分形维数的特征提取. 针对每一
   类的特征提取方法, 进一步研究了它相应的分类方法和它在时间序列数据中的应用邻域.
   关键词: 时序数据; 分类; 特征提取
   Survey of Feature Extraction Approaches for Time Series Classification
   LIN Zhu1 , XING Yan2
   (Guangdong Computer Center, Guangzhou 510033, China)
   (Guangdong University of Technology, Guangzhou 510006, China)
   Abstract: The main contributions of this paper are: 1) The main feature extraction approaches are classified into four
   categories; 2) The main idea of each category is analyzed, the advantages and disadvantages are pointed out; 3) The
   guidelines of choosing suitable feature extraction approach is suggested.
   Key words: time series; classification; feature extraction
** 1 引言
   时序数据(time series data)广泛存在于现实生活中,是指同一种现象在不同时间上的相
   继观察值排列而成的一组数字序列, 其时间轴上的采样值通常又被称为特征[1]. 时序数
   据普遍存在于许多重要应用邻域, 比如 DNA 序列、金融数据、传感器网络监控数据、移
   动对像跟踪数据、机器故障检测数据等等. 由于时序数据与时间相关联, 因而其数据量
   一般都是非常庞大的,这就对时序数据挖掘技术提出了更高的要求[2]. 在时序数据挖掘
   的研究与应用领域, 时序数据分类是重要任务之一[1,2]. 例如, 依据语音信号的波形识
   别出说话人的性别和年龄, 依据心电图的时序波形识别出病者所患的病症, 依据地震波
   的历史数据, 去识别地震的类型, 依据在机器运转过程中进行故障检测和识别故障类型,
   甚至在客户关系管理中根据某段时间的客户购买信息, 识别不同的消费群体等等. 衡量
   分类技术优劣的核心指标是分类准确率, 而提高分类准确率途径有两种: 一是改进分类
   器; 二是采用特征提取技术(feature extraction). 特征提取是在分类前对数据时间采
   样值上进行适量的归约, 以达到减少数据量同时提高分类准确率(底线是不牺牲分类准确
   率)的目的. 时间序列除了具有的趋势性、季节性、周期性等一般特征之外, 不同的时序
   数据又存在不同的个别特征. 如金融数据, 普遍具有“高峰厚尾”和“平方序列微弱而
   持续的自相关”的特点; 而地震波则具有强度随时序延伸而减弱的特点; 语音信号幅度
   具有一定的范围, 并以零幅和近零幅的概率高, 而且长时间的语音信号会有相当多的无
   信号区间, 即所谓的语音寂静区间; 心电信号则具有很强的周期性, 它的主要特征是低
   电压(0.8~1mV), 小电流(12uA), 重复频率低, 每个波段具有各自的频率. 针对时序数据
   的这些特征, 所选择的特征提取方法应该能提取出时间序列中具有较好分类能力特征,
   进行特征提取后的特征矢量能够很好地代表原有的时间序列数据, 这样才能取得良好的
   分类效果. 本文对分类中常用的时序特征提取方法归纳和总结, 现阶段特征提取方法主
   要有四类, 分别是基于基本统计方法的特征提取, 基于模型的特征提取, 基于变换的特
   征提取以及基于分形理论的特征提取. 针对每一类特征提取方法, 本文总结了各自适用
   的应用领域, 并提及相应的分类方法.
** 2 特征提取方法综述
   特征提取的方法有很多, 总结起来可以归为四大类:

   基于基本统计方法的特征提取,
   基于模型的特征提取,
   基于变换的特征提取,
   基于分形维数的特征提取.

   通过这些特征提取后的特 征矢量, 能够达到较好的分类效果.
*** 2.1 基于基本统计方法的特征提取
    基本统计方法的特征提取, 就是提取数据波形的均值, 方差, 极值, 波段, 功率谱, 过零点
    等统计特征来代表原有的时序数据作为特征矢量. 时域的常见基本统计征有均值, 方差, 极
    值, 过零点, 边界点[3], 波段的长短峰值等, 而频域的基本统计方法有功率谱,功率密度比,
    中值频率, 平均功率频率等. 在肌电信号(EMG)数据中, 常采用的时序统计特征为过零点数,
    积分肌电值, 方差等, 而频域中则常采用 EMG 功率谱的平均功率频率和中值频率[4]. ECG
    中则常提取它的R－R 间隔均值、熵值、变化值、功率谱密度等, 而脑电信号(EEG)则常提取
    它的峰值, 熵值[5], 非线性能量等[6], 或是提取 QRS 波的峰值、波长等, QT 间隔, ST
    间隔等统计特征[6,7]. 基于统计特征提取后的特征矢量, 可采用线性判别式构造分类器;
    也可采用神经网络进行分类, 此时可达到较好效果[7,8]. 它适用于信号波形的统计特征比
    较明显的时间序列数据, 如 EEG 信号、ECG 信号等医学数据.
*** 2.2 基于模型的特征提取
    基于模型的特征提取, 是指用模型去刻画时间序列数据, 然后提取模型的系数作为特征矢量
    去进行分类. 对于平稳时间序列, 可用通用 ARMA 模型(自回归滑动平均模型)及其特殊情况
    的自回归模型、滑动平均模型(MA)或组合-ARMA 模型等来进行拟合. 对于非平稳时间序列则
    要先将观测到的时间序列进行差分运算, 化为平稳时间序列, 再用适当模型去拟合这个差分
    序列. 当然, 不同的时序数据都会有比较适合它的模型去进行特征提取. 如对于 ECG 数据,
    通常采用AR 模型进行特征提取, 而相对应的 MAR 模型则用于多通道的 ECG 数据中[9-11].
    AR 模型是一个线性的, 二阶矩平稳模型, 比较适合短数据分析, 不仅在 ECG 数据中具有优
    势, 在肌电信号(EMG)中也是如此. Graupe在研究用肌电信号进行动作识别时, 已证实了 AR
    模型比 ARMA 模型更具优势. 近年来的研究也表明, 用AR 模型进行特征提取时, 识别率是
    非常之高[4]. 而对于金融时序数据, 常用的多元线性回归和 ARMA 模型等都不再适合, 针
    对金融市场的价格波动聚集现象,应采用 ARCH 模型(自回归条件异方差族计量模型) [12];
    而采用 SVAR(结构向量自回归)模型更加适合刻画金融数据中常出现的“高峰厚尾”和“弱
    自相关”现象[13]. 选择合适的模型进行特征提取, 产生的模型系数作为特征矢量. 针对这
    类特征矢量, 往往采用简单的判别函数即可达到理想的分类效果. 最常用的当属二次判别函
    数(QDF) [9,10]. 有时也用到最大似然的判断规则进行分类[14].
*** 2.3 基于变换的特征提取
    通过变换的手段, 使适合分类的特性突显出来,也是经常用到的特征提取方法. 变换包括时
    频变换和线性变换. 时频变换中具有代表性的方法是快速傅立叶变换、短时傅立叶变换、倒
    谱系数等. 而线性变换,主要有 PCA、ICA、SVD、线性判别式分析、要素分析、映射等等.
    其中最有代表性的是 PCA 和 K－L 变换, 还有著名的小波变换、小波包技术.
**** 2.3.1 基于时频变换的特征提取
     时频变换是将信号从时域变换到频域的一种手段. 时间序列数据在特征提取中常采用傅立叶
     变换、倒谱帕克受伤离场哈登低迷难挡小卡34分系数等时频变换方法. 傅里叶变换是将时域的信号变换成频域的信号,它是把时
     域的信号变换成由频率, 幅值和相位的正弦波的组合. 将时序数据进行傅立叶变换, 然后选
     择它的系数作为特征矢量, 若选择前面的系数, 则代表了信号的低频特性, 选择较大的系数,
     则代表了信号的能量特征[15]. 在心电信号 QRS 波识别中用 DFT 有效进行降维和提取特征,
     然后用神经网络进行分类,其敏感度可高达 98％[16]. 在股市中应用傅立叶变换与反变换,
     可以有效去除噪声和进行数据约简[17]; 亦可通过傅立叶变换求取功率谱, 来表征时序数据
     的统计特征[18]. 为了减少傅立叶变换的运算量, 可运用快速傅立叶变换算法, 它利用 DFT
     系数的对称性, 周期性和可约性等性质将长序列的 DFT 分解为若干个短序列的DFT 运算,
     其中, 最常用的是 FFT 的表达形式是按时间抽取的基 2 FFT 算法, 然后提取频率系数作为
     特征矢量[16]. 短时傅立叶变换(Short-Time Fourier Transform, STFT)建立在传统的傅立
     叶变换基础之上. 其基本思想是将信号 s(t)用窗函数 w(t)截断, 并让该窗函数沿着信号滑
     动, 于是分为一个个短时信号, 并对这些短时信号分别进行快速傅立叶变换进行频谱分析,
     从而能更精确地观察出信号的频谱变化情况. 窗函数的长短选择决定了时频特征体现的强弱
     (窗较宽时频域性较强, 时域性较弱) [19]. 特征提取还经常用到倒谱系数也作为信号的特
     征矢量. 倒谱分析又称为二次频谱分析, 它分为实倒频谱和复倒频谱. 其中实倒谱又为功率
     倒频谱, 它是先将时序信号进行离散傅立叶变换, 然后取自然对数,再实行离散傅立叶反变
     换. 复倒谱是将时序信号通过Z 变换以后取对数,再求反 Z 变换而得到的. 倒谱系数应用最
     广泛的领域是在语音信号中[20-23], 包含梅尔倒谱和线性预测倒谱, 其识别效果优于其它
     特征提取方法, 其中梅尔倒谱又要优于线性倒谱[24]. 针对倒谱提取出来的特征矢量, 语音
     信号常用 HMM 模型进行分类识别.
**** 2.3.2 基于线性变换的特征提取
     线性变换中有很多特征提取方法颇为经典, 特别是 PCA 和小波变换. PCA 为主成分分析,
     它与独立成分分析 ICA, K－L 变换, 奇异值分解极为相似, 有殊途同归的效果,在数据降维
     中都经常用到. 研究表明, 利用 PCA 变换可以在信息损失最小的前提下, 用较少的分量代
     替原来的高维数据, 达到降维的效果, 从而使得处理数据的时问和费用大大降低. 另一方面,
     由于各主成分是相互垂直的, 所以增大了类间距, 减小了类内差异, 可提高分类精度
     [25,26]. 但 PCA 不能解决非线性特征提取, 对于非线性数据, 提出了核主成分分析的观点.
     它是通过一个非线性映射, 把输入数据映射到一个高维的特征空间, 在特征空间上进行线性
     主成分分析[27,28], 其优点是要求的数据量小, 并具有很好的抗噪能力[29]. 应用 PCA 或
     核主成分分析进行数据降维后, 往往会进一步进行特征提取, 使数据进一步压缩[30,31].
     特别是核主成分分析, 特征提取后的维数仍会很高,应进一步找寻降维的方法. 用 PCA 进行
     特征提取后的特征矢量, 常采用最近邻方法[32,33]、HMM 模型进行分类[33], 特别是采用
     神级网络[34,35], 可达到较高的分类准确率. 即使用最简单的 BP 网络, 也有较满意的结
     果[36]. 小波变换是将信号分解到不同尺度的线性变换. 基于小波变换的特征提取有多种,
     如提取模极大值特征, 能量特征, 熵特征, 以及适应性小波网络的特征提取等[37]. 如在
     ECG 信号的特征提取中, 最常用的是基于模极大值的特征提取它蕴含了原始信号的大部分重
     要信息, 可以将其尺度参数 S, 平移参数 T 及其幅值作为心电信号的特征量[38]. 小波变
     换在所有的时序数据中都得到广泛应用,但对于不同的时序数据进行特征提取时, 应选择不
     同的小波基, 常用的小波基有: Haar 小波基, Daubechies小波基系列, Coiflets 小波基系
     列, Symlets 小波基系列, Biorthogonal小波基系列等等. 通常我们选择小波函数时应遵守
     两条原则: (1)对于复数信号应用复数母小波; (2)母小波的形状应与被分析的信号相类似.
     在对心电信号进行模极大值特征提取时, 通常选择 Mexican hat小波函数[39], 这是因为它
     的形状与被分析信号相类似以及较好的时域分辨率. 而对于股市数据, 用具有良好的正交性
     和紧支撑性的 Daubechies 小波系、Coiflets小波系、Symlets 小波系会比其他小波系效果
     好[40]. 而地震波中, Dubieties 小波族中 的 Db4 是很适合进行岩石声信号处理[41]; 小
     波包技术不同于小波技术, 它将频率轴分成不同大小的区间, 这一特点特别适合地震波, 因
     为地震波强度随着传递频率明显衰减. 在地震波特征提取中运用小波包技术优于傅立叶变换
     [42]. 同时, 可以将小波系数和核函数方法相结合进行特征提取, 识别率高达 100%[43].
     对于小波技术提取出的特征矢量, 可以采用平面鉴别法, 距离分类器等, 但最常见的分类方
     法是神经网络和 SVM, 并且都能取得较好的分类效果[44-46].
*** 2.4 基于分形理论的特征提取
    分形是指具有: 无限精细、非常不规则、无穷自相似结构和非整数的点集. 在大自然中, 海
    岸线、雪花,云雾这些不规则形体都属于分形, 即部分与整体有自相似性[47]. 分形学与混
    沌学息息相关, 成为非线性科学的两大重要组成部分, 分形理论真正发展只有十余年, 但应
    用于特征提取已越来越广泛, 特别是在时间序列中. 但分形理论进行特征提取时, 并不是所
    有信号都适合. 要看信号在某个尺度下是否具有可分形特征, 即不同状态下的分形维数是不
    同的, 这样才具有可分性. 如故障诊断中, 将信号分为 N 个状态, 每个状态可提取一个分
    形维数作为特征参数, 把这个分维数与学习好的故障分类结果比较, 可判断是否有故障发生
    [48]. 分形理论用于特征提取时, 主要是针对非线性信号, 是用它的定量分析指标分维数作
    来特征矢量. 分维数是指空间的扩展程度, 可以用分数来表示, 它的提出可定量很多有争议
    的数据, 比如一直测不准的英国海岸线[25]. 分维数有多种, 其中相似维数, 适用于严格相
    似的一小类集合豪斯道夫维数难于计算, 盒维数在稠密可列集上与集所在空间维数相等
    [47], 对于一维的时间序列, 关系维是最简单实用的方法[48]. 分形理论是研究非线性时序
    变量的有力武器, 可揭示出复杂系统下的旱、洪灾害时序变化的内在规律[49], 也可用于股
    票离群点的检测[50], 采用多重分形特征对金融管理或风险预测数据进行分类[51], 分维数
    用于心博分类时, 准确率可高达 99.49％[52]. 分形维数只得到一个数值作为特征矢量, 利
    用此特征矢量, 用贪婪算法, 或设定阀值即可进行分类, 当然, 它作为一个非线性参数, 也
    可以跟李雅谱诺指数, 小波技术提到的参数一起组成特征矢量进行分类[53].
*** 2.5 小结
    上述四大类的特征提取方法在分类过程中都得到了广泛的应用. 但对于具体的应用领域, 应
    选择较为适合该领域数据的特征提取方法, 才能较好地提取该数据的特征. 而对于不同的特
    征提取方法进行提取后的特征矢量, 也有较为适合并常用的分类方法. 因此,对于上述方法,
    可以总结为表 1 所示:表 1 各类特征提取方法
    #+DOWNLOADED: /tmp/screenshot.png @ 2017-05-05 17:53:46
    [[file:数据挖掘中适用于分类的时序数据特征提取方法/screenshot_2017-05-05_17-53-46.png]]
** 3 结论与展望
   综上所述, 这四大类的特征提取方法都广泛应用于时序数据, 而且各有千秋, 对于具体数据,
   可以选择其中比较适合它的特征提取, 如股票时序, 往往采用模型的方法会比较能表征它的
   波动特征. 基于统计特征的方法最早得到发展, 也最为简单, 但在信号有强噪声的情况不是
   很适合, 而基于变换的方法, 无论是小波变换还是主成分分析, 在当今应用得最为广泛,可
   以达到很好的分类效果. 而针对信号常常出现的非线性情况, 我们可以采用分形理论去解决,
   提取信号的分形维数进行分类. 考虑到时序信号的复杂性, 可以采用多种特征提取方法的结
   合, 如求倒谱系数时可以结合到 LPC 线性预测方法, 而通常我们也会把小波技术跟分形理
   论结合. 多种方法的综合将会是未来研究特征提取的主要方向.
